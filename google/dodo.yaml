backdrops:
  gcloud:
    image:
      name: dodo/google
      requires: [dodo/base, dodo/languages/python]
      context: '{{ currentDir }}'
      dockerfile: '{{ currentDir }}/Dockerfile.yaml'
    volumes:
      - 'gcloud-data:/home/dodo/.config/gcloud'
      - '{{ projectRoot }}:/build'
    working_dir: '/build/{{ projectPath }}'
    script: |
      mkdir -p /home/dodo/.config/gcloud/configurations
      cp /home/dodo/.gcloud/* /home/dodo/.config/gcloud/configurations/
      exec gcloud "$@"

  gam:
    image:
      name: dodo/google
      requires: [dodo/base, dodo/languages/python]
      context: '{{ currentDir }}'
      dockerfile: '{{ currentDir }}/Dockerfile.yaml'
    volumes:
      - 'gpg-agent:/data/gpg-agent'
      - 'passwords:/data/passwords'
      - '{{ projectRoot }}:/build'
    working_dir: '/build/{{ projectPath }}'
    script: |
      set -eux
      exec /home/dodo/gam/gam "$@"
