backdrops:
  session:
    image:
      name: dodo/session
      requires: [dodo/base, dodo/languages/buildbase, dodo/languages/rust, dodo/languages/ruby]
      context: '{{ currentDir }}'
      dockerfile: '{{ currentDir }}/Dockerfile'
    interactive: true

  tmux-client:
    aliases: tmux
    image:
      name: dodo/tmux
      requires: dodo/base
      steps: |
        FROM dodo/base
        RUN apt-get update && apt-get -y install tmux
    volumes: 'tmux-data:/data/tmux'
    environment: 'TMUX_TMPDIR=/data/tmux'
    user: dodo
    script: |
      if [ $# != 0 ]; then
        exec tmux "$@"
      else
        exec tmux -2 attach -t default
      fi
