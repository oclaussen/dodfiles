backdrops:
  aws:
    image:
      name: dodo/aws
      requires: [dodo/base, dodo/languages/python, dodo/pass]
      context: '{{ currentDir }}'
      dockerfile: '{{ currentDir }}/Dockerfile'
    volumes:
      - 'gpg-agent:/data/gpg-agent'
      - 'passwords:/data/passwords'
      - '{{ projectRoot }}:/build'
    working_dir: '/build/{{ projectPath }}'
    script: |
      if [ "$1" = "accountid" ]; then
        shift
        exec print_account_id.py "$@"
      elif [ "$1" = "accountids" ]; then
        exec print_account_id.py --all
      else
        exec aws "$@"
      fi
